 #### Guia del laboratorio

 #### Consideraciones:
_35GB de almacenamiento disponible para vmware, si quedas con poco espacio puedes ver este tutorial https://www.youtube.com/watch?v=NwpzYlfKnrY
_2-4GB de ram para la utilización del laboratorio
- Uso de sudo -s


 #### IMPORTANTE :

PARA ESTE LAB LAS CREDENCIALES DE LOGIN SSH SERA LA CONTRASEÑA DEL USUARIO AUNQUE SE TRATO DE HACER DE LA MANERA USUAL SON AUTHENTICATED_KEYS OSEA LLAVES SSH DE FORMA ID_RSA.PUB

 #### PARA CAMBIAR CONTRASEÑA
sudo passwd root

 #### COPIA REMOTA DE CREDENCIALES

ssh-copy-id -i /root/.ssh/id_rsa.pub root@10.5.0.5


 #### Pasos para correr el laboratorio:

_Instalar una máquina virtual con vmware con la iso de Kali Linux 
-VMWARE -> https://www.vmware.com/cl/products/workstation-player/workstation-player-evaluation.html
-ISO KALI LINUX -> https://www.kali.org/get-kali/

_Una vez instalada la distro en la maquina virtual correrla y proceder a ejecutar el siguiente comando en una terminal
-	->   git clone https://github.com/nlavanderos/pentest_usach
-	->  el siguiente paso es hacer cd a la carpeta de pentest_usach

#### Generacion,dependecias y permisos 

Reemplazar usuario por el usuario eligido en la instalacion de kali

- sudo apt install openssh-server
- en escritorio chmod 755 /home/usuario/Desktop
- ssh-keygen
- sudo chown usuario:usuario /home
- sudo chmod 755 /home
- chmod 644 ~/.ssh/id_rsa.pub
- chmod 600 ~/.ssh/id_rsa
- chmod 700 ~/.ssh

EN LA CARPETA ETC/KALI DEL REPO TIENE QUE COPIAR LA CREDENCIAL id_rsa.pub contenida en ~/.ssh Y CAMBIARLE EL NOMBRE A authorized_keys

el comando que tiene que usar es cp

- ssh-copy-id -i /root/.ssh/id_rsa.pub root@10.5.0.5




 #### En el directorio antes de ejecutar el script de lab.sh
 
-	Deberás darle permisos al script, para evitar el uso de sudo -> chmod +x ./lab.sh     
-	Correr el script para verificar dependencias -> ./lab.sh -C
-	Bajar las dependencias en este caso las asociadas a Docker,pip3,Docker compose y yq
-	sudo apt install docker.io  
-	sudo apt install docker-compose
-	sudo apt install python3-pip
-	sudo pip3 install yq
-	
En caso de algún error al ejecutar por ejemplo docker deberás siempre dar permisos chmod, para docker seria 
sudo chmod 666 /var/run/docker.sock

_Para ver los commandos que puedes ejecutar en el laboratorio deberás ejecutar
./lab.sh –help

  #### FUNCIONALIDADES

  -h | --help                Print this usage.
  -i | --info                Print generall information.
  -o | --overview TEXT       Print overview table of services. [default: all]
                                Options: red_team
                                TEXT is a space separated list like: 'red_team '.
  -B | --build               Build the lab and not start it.
  -u | --up                  Start pentest lab if not allready running.
  -d | --down                Stop pentest lab if not allready stopped.
  -R | --remove              Remove files like SSH keys from local dir.
  -p | --prune               Prune pentest lab after stopping.
                                This will delete images, networks, containers and volumes.
                                All data stored in persistent volumes will be lost.
  -C | --check-dependencies  Check for all mandatory dependencies.
  -A | --all-services        Set lab to run all available services.


 #### Para corer el lab debes hacer un up como primer paso.
./lab.sh --up --all-services

 #### Para detener el lab/contenedores..etc
./lab.sh --down


 #### Si desea restablecer el laboratorio y comenzar de nuevo por completo, puede usar
 ./lab.sh -p | --prune  


 #### Rangos de IP

La razón por la que usamos direcciones IP estáticas es que la caja de Kali necesita tener una dirección IP que no cambie para simplificar el inicio de sesión SSH.

- Los servicios para las víctimas(victim) comienzan en 10.5.0.100
- Los servicios del red team comienzan en 10.5.0.5
- El servicio Kali tiene 10.5.0.5.


 #### Información del lab
./lab.sh --overview all  


 #### Para entrar a la maquina
sudo ssh root@10.5.0.5 -o "UserKnownHostsFile /dev/null" 


 #### NOMBRE ALUMNO : NICOLAS LAVANDEROS
 #### CORREO: n.lavanderosflores@gmail.com
